<!DOCTYPE html>
<html>
	<head>
		<title> My First Express App</title>

		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">


  		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  		<script type="text/javascript">
			function searchName(){
				var mess = document.getElementById('search').value;
				if(mess!=''){
					var i=0;
					while(document.getElementsByClassName('studentName')[i]){
						if(document.getElementsByClassName('studentName')[i].innerHTML.indexOf(mess)!=-1 || String(document.getElementsByClassName('studentRno')[i].innerHTML).indexOf(mess)!=-1){
							document.getElementsByClassName('student_details')[i].style.display = '';
							// document.getElementsByClassName('student_details')[i].removeAttribute('style');
						}
						else{
							document.getElementsByClassName('student_details')[i].style.display = 'none';
						}
						i=i+1;
					}
				}
				else{
					var i=0;
					while(document.getElementsByClassName('studentName')[i]){
						document.getElementsByClassName('student_details')[i].style.display = '';
						// document.getElementsByClassName('student_details')[i].removeAttribute('style');
						i=i+1;
					}
				}
			}
		</script>

	</head>
	<body>
		<nav>
			<a href="/admin_home" class="active">Home</a>
			<a href="/admin_change_details">Manage</a>
			<a href="/admin_profile">Profile</a>
		</nav>
		<h1>Hello <%=user%></h1>

		<%if(0){ %>
		<p>Please <a href='/admin_login'>login</a></p>
		<%}else{ %>

		<form method="post">
			<p>Date: <input type="date" name="date" required="true" /></p>
			<p>Year of admission: <input type="number" name="year" required="true" /></p>
			<input type="submit" name="submit" value="Submit">
		</form>
		<% if(typeof error != "undefined"){ %>
		<p style="color: red"><br/><%= error%></p>
		<%}else if(typeof students != "undefined"){%>

			<h4>List of Absentees</h4>
			<h5>Year: <%=year%></h5>
			<h5>Date: <%=date%></h5>
			<form method='post'><p>Search: <input type="text" name="search" id='search' onkeyup="searchName()" placeholder="Search for name or rollno" /></p></form>	
			<table>
				<tr><th>Name</th><th>Rno</th><th>Hostel Name</th><th>Room No</th><th>Branch Name</th><th>Email ID</th><th>Phone No</th><th>Total Attendance</th></tr>
				<% var keys = Object.keys(students)%>
				<% keys.forEach(function(key){ %>
					<tr class="student_details">
						<td class="studentName"><%=students[key].Name%></td>
						<td class="studentRno"><%=key%></td>
						<td><%=(students[key].HostelName)%></td>
						<td><%=(students[key].RoomNo)%></td>
						<td><%=(students[key].BranchName)%></td>
						<td><%=(students[key].EmailID)%></td>
						<td><%=(students[key].PhoneNo)%></td>
						<td><%=(students[key].TotalAttendance)+'/'+total_days%></td>
					</tr>
				<%});%>
			</table><br/>
		<%}%>
		
		

		<%} %>

	</body>
</html>
